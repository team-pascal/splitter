openapi: "3.0.3"
info:
  title: Splitter API
  version: '1.0'
  description: |-
    This is a Splitter API
tags:
  - name: Groups
  - name: Users
  - name: Payments
paths:
  /groups:
    post:
      tags:
        - Groups
      description: |-
        Register the group and splitter members.
        For top page.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                users:
                  type: array
                  items:
                    type: string
            example:
              name: "Team 1"
              users: [
                "Alice",
                "Bob",
                "Charle",
                "Dave"
              ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  group:
                    $ref: "#/components/schemas/Group"
                  users: 
                    type: array
                    items:
                      $ref: "#/components/schemas/User"
              example:
                group:
                  id: "sSdaixpwYCCpeY4b"
                  name: "Team A"
                  created_at: 1714372101
                  deleted_at: null
                  updated_at: 1714372101
                users: [
                  {
                    id: "xVi3UAESJ9M2PntD",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Alice",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "c8GryJjwr863GwzH",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Bob",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "7RGnEXHHtrJxPemi",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Charle",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "VQFATEpJXAT_65Qk",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Dave",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  }
                ]
        '400':
          description: Invalid group or users
        '422':
          description: Validation exception
  /groups/{id}:
    get:
      tags:
        - Groups
      description: |-
        Get information of group.
      responses:
        '200':
          description: OK
    patch:
      tags:
        - Groups
      description: |-
        Change information of group.
      responses:
        '200':
          description: OK
  /users:
    post:
      tags:
        - Users
      description: |-
        Add an user.
      responses:
        '200':
          description: OK
  /users/list/{group_id}:
    get:
      tags:
       - Users
      description: |-
        Get list of users.
        For register page.
      parameters:
        - name: group_id
          in: path
          required: true
          schema: 
            type: string
          example: "sSdaixpwYCCpeY4b"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
              example:
                [
                  {
                    id: "xVi3UAESJ9M2PntD",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Alice",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "c8GryJjwr863GwzH",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Bob",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "7RGnEXHHtrJxPemi",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Charle",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    id: "VQFATEpJXAT_65Qk",
                    group_id: "sSdaixpwYCCpeY4b",
                    name: "Dave",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  }
                ]
        '400':
          description: Invalid Group ID
        '404':
          description: Users of group not found
        '422':
          description: Validation exception
  /users/{id}:
    get:
      tags:
        - Users
      description: |-
        Get information of an user.
      responses:
        '200':
          description: OK
    delete:
      tags:
        - Users
      description: |-
        Delete an user.
      responses:
        '200':
          description: OK
    patch:
      tags:
        - Users
      description: |-
        Update the information of an user.
      responses:
        '200':
          description: OK
  /payments/split:
    post:
      tags:
        - Payments
      description: |-
        Register the payment information.
        For register payment page.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                group_id:
                  type: string
                is_split:
                  type: boolean
                lessors:
                  type: array
                  items:
                    type: object
                    properties:
                        user_id:
                          type: string
                        amount:
                          type: integer
                          format: int64
                lessees:
                  type: array
                  items:
                    type: string
            example:
              title: "Burgers of Mickey D's"
              group_id: "sSdaixpwYCCpeY4b"
              is_split: true
              lessors: [
                {
                  user_id: "xVi3UAESJ9M2PntD",
                  amount: 4000
                },
                {
                  user_id: "c8GryJjwr863GwzH",
                  amount: 1300
                }
              ]
              lessees: [
                "7RGnEXHHtrJxPemi",
                "VQFATEpJXAT_65Qk"
              ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  split:
                    $ref: "#/components/schemas/Split"
                  lessors:
                    type: array
                    items:
                      $ref: "#/components/schemas/SplitLessor"
                  lessees:
                    type: array
                    items:
                      $ref: "#/components/schemas/SplitLessee"
              example:
                split:
                  id: "S4fbP8dRVrwA-AiK"
                  title: "Burgers of Mickey D's"
                  amount: 5300
                  group_id: "sSdaixpwYCCpeY4b"
                  done: false
                  created_at: 1714372101
                  deleted_at: null
                  updated_at: 1714372101
                lessors: [
                  {
                    split_id: "S4fbP8dRVrwA-AiK",
                    user_id: "xVi3UAESJ9M2PntD",
                    amount: 4000,
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    split_id: "S4fbP8dRVrwA-AiK",
                    user_id: "xVi3UAESJ9M2PntD",
                    amount: 4000,
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                ]
                lessees: [
                  {
                    split_id: "S4fbP8dRVrwA-AiK",
                    user_id: "7RGnEXHHtrJxPemi",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    split_id: "S4fbP8dRVrwA-AiK",
                    user_id: "VQFATEpJXAT_65Qk",
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                ]
        '400':
          description: Invalid Split, Lessors or Lessees
        '422':
          description: Validation exception
  /payments/replacement:
    post:
      tags:
        - Payments
      description: |-
        Register the payment of replacement information.
        For register payment page.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                group_id:
                  type: string
                is_split:
                  type: boolean
                lessors:
                  type: array
                  items:
                    type: object
                    properties:
                        user_id:
                          type: string
                        amount:
                          type: integer
                          format: int64
                lessees:
                  type: array
                  items:
                    type: object
                    properties:
                        user_id:
                          type: string
                        amount:
                          type: integer
                          format: int64
            example:
              title: "Snack"
              group_id: "sSdaixpwYCCpeY4b"
              lessors: [
                {
                  user_id: "xVi3UAESJ9M2PntD",
                  amount: 300
                }
              ]
              lessees: [
                {
                  user_id: "7RGnEXHHtrJxPemi",
                  amount: 100
                },
                {
                  user_id: "VQFATEpJXAT_65Qk",
                  amount: 200
                }
              ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  split:
                    $ref: "#/components/schemas/Replacement"
                  lessors:
                    type: array
                    items:
                      $ref: "#/components/schemas/ReplacementLessor"
                  lessees:
                    type: array
                    items:
                      $ref: "#/components/schemas/ReplacementLessee"
              example:
                split:
                  id: "S4fbP8dRVrwA-AiK"
                  title: "Burgers of Mickey D's"
                  amount: 300
                  group_id: "sSdaixpwYCCpeY4b"
                  done: false
                  created_at: 1714372101
                  deleted_at: null
                  updated_at: 1714372101
                lessors: [
                  {
                    split_id: "dRdJ_jJjiFK2AAwD",
                    user_id: "xVi3UAESJ9M2PntD",
                    amount: 300,
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  }
                ]
                lessees: [
                  {
                    split_id: "dRdJ_jJjiFK2AAwD",
                    user_id: "7RGnEXHHtrJxPemi",
                    amount: 100,
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                  {
                    split_id: "dRdJ_jJjiFK2AAwD",
                    user_id: "VQFATEpJXAT_65Qk",
                    amount: 200,
                    created_at: 1714372101,
                    deleted_at: null,
                    updated_at: 1714372101
                  },
                ]
        '400':
          description: Invalid Split, Lessors or Lessees
        '422':
          description: Validation exception
  /payments/list/{group_id}:
    get:
      tags:
        - Payments
      description: |-
        Get the information of payments.
        For main page.
      parameters:
        - name: group_id
          in: path
          required: true
          schema: 
            type: string
          example: "sSdaixpwYCCpeY4b"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Payment"
              example: [
                    {
                      "id": "S4fbP8dRVrwA-AiK",
                      "title": "Burgers of Mickey D's",
                      "amount": 5300,
                      "group_id": "sSdaixpwYCCpeY4b",
                      "is_split": true,
                      "done": false,
                      "created_at": 1714372101,
                      "deleted_at": null,
                      "updated_at": 1714372101
                    },
                    {
                      "id": "WFCK3Qm88RA9sDsj",
                      "title": "Dinner in restaurant",
                      "amount": 22000,
                      "group_id": "sSdaixpwYCCpeY4b",
                      "is_split": true,
                      "done": true,
                      "created_at": 1714372101,
                      "deleted_at": null,
                      "updated_at": 1714372101
                    },
                    {
                      "id": "dRdJ_jJjiFK2AAwD",
                      "title": "Snack",
                      "amount": 300,
                      "group_id": "sSdaixpwYCCpeY4b",
                      "is_split": false,
                      "done": false,
                      "created_at": 1714372101,
                      "deleted_at": null,
                      "updated_at": 1714372101
                    },
              ]
        '400':
          description: Invalid Group ID
        '404':
          description: Group not found
        '422':
          description: Validation exception
  /payments/{id}:
    get:
      tags:
        - Payments
      description: |-
        Get the information of payments.
      responses:
        '200':
          description: OK
    delete:
      tags:
        - Payments
      description: |-
        Delete the information of payments.
      responses:
        '200':
          description: OK
    patch:
      tags:
        - Payments
      description: |-
        Update the information of payments.
      responses:
        '200':
          description: OK
  /payments/done:
    post: 
      tags:
        - Payments
      description: |-
        Finish split money.
      responses:
        '200':
          description: OK
  /payments/doing:
    post: 
      tags:
        - Payments
      description: |-
        Unfinish split money.
      responses:
        '200':
          description: OK

components:
  schemas:
    Group:
      type: "object"
      properties:
        id:
          type: string
          example: "sSdaixpwYCCpeY4b"
        name:
          type: string
          example: Team A
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: 1714372101
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    User:
      type: "object"
      properties:
        id:
          type: string
          example: "fU3r756xLhQLhmBu"
        group_id:
          type: string
          example: "sSdaixpwYCCpeY4b"
        name:
          type: string
          example: "Alice"
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: 1714372101
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    Payment:
      type: "object"
      properties:
        id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        title:
          type: string
          example: "Burgers of Mickey D's"
        amount:
          type: integer
          example: 5300
        group_id:
          type: string
          example: "sSdaixpwYCCpeY4b"
        is_split:
          type: boolean
          example: true
        done:
          type: boolean
          example: false
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    Split:
      type: "object"
      properties:
        id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        title:
          type: string
          example: "Burgers of Mickey D's"
        amount:
          type: integer
          example: 5300
        group_id:
          type: string
          example: "sSdaixpwYCCpeY4b"
        is_split:
          type: boolean
          example: true
        done:
          type: boolean
          example: false
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    Replacement:
      type: "object"
      properties:
        id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        title:
          type: string
          example: "Burgers of Mickey D's"
        amount:
          type: integer
          example: 5300
        group_id:
          type: string
          example: "sSdaixpwYCCpeY4b"
        is_split:
          type: boolean
          example: true
        done:
          type: boolean
          example: false
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    SplitLessor:
      type: object
      properties:
        split_id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        user_id:
          type: string
          example: "fU3r756xLhQLhmBu"
        amount:
          type: integer
          example: 4000
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    SplitLessee:
      type: object
      properties:
        split_id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        user_id:
          type: string
          example: "fU3r756xLhQLhmBu"
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    ReplacementLessor:
      type: object
      properties:
        split_id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        user_id:
          type: string
          example: "fU3r756xLhQLhmBu"
        amount:
          type: integer
          example: 4000
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101
    ReplacementLessee:
      type: object
      properties:
        split_id:
          type: string
          example: "S4fbP8dRVrwA-AiK"
        user_id:
          type: string
          example: "fU3r756xLhQLhmBu"
        created_at:
          type: integer
          format: int64
          example: 1714372101
        deleted_at:
          type: integer
          format: int64
          example: null
        updated_at:
          type: integer
          format: int64
          example: 1714372101